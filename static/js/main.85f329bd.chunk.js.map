{"version":3,"sources":["upload/seams.js","upload/loadImage.js","upload/Uploader.js","App.js","reportWebVitals.js","index.js"],"names":["addSeamVertical","img","seam","toRet","unrolled","tolist","r","shape","push","c","get","pixel","splice","nj","array","addSeam","horizontal","transpose","addSeamHorizontal","addSeamToMapVertical","set","addSeamToMap","addSeamToMapHorizontal","removeSeamVertical","removeSeam","removeSeamHorizontal","doEnergyCalculation","cwise","args","offset","body","y","xR","xG","xB","xRN","xGN","xBN","xRE","xGE","xBE","Math","sqrt","getEnergy","mask","h","w","oShape","out","NdArray","Uint16Array","selection","pick","g","b","add","getMinimumSeamVertical","energy","backtrack","zeros","i","j","e","o","argmin","slice","flatten","unshift","getMinimumSeam","getMinimumSeamHorizontal","populateImage","$image","iter","$mask","images","read","$original","document","getElementById","width","height","save","rgb2gray","$maskCanvas","querySelector","checked","shouldAddSeams","Promise","resolve","reject","seams","processing","clone","processingMask","timesRun","interval","setInterval","clearInterval","energyMap","energyWithSeam","$energy","withoutSeam","$seam","removeSeams","then","length","pop","remainingSeam","diff","clip","subtract","multiply","addSeams","textContent","Uploader","props","handleChange","setState","target","value","state","image","isButtonDisabled","src","isMask","Image","crossOrigin","onload","file","files","reader","FileReader","this","loadImage","result","readAsDataURL","className","type","id","name","num","onChange","htmlFor","handleFileSelect","onClick","processImage","disabled","React","Component","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.85f329bd.chunk.js","sourcesContent":["// From https://jsfiddle.net/nicolaspanel/047gwg0q/\nimport nj from \"numjs\";\nimport cwise from \"cwise\";\nimport { argmin } from \"ndarray-ops\";\n\nfunction addSeamVertical(img, seam) {\n  const toRet = [];\n  const unrolled = img.tolist();\n\n  for (let r = 0; r < img.shape[0]; r++) {\n    toRet.push(unrolled[r]);\n    const c = seam.get(r);\n    const pixel = [\n      (img.get(r, c-1, 0) + img.get(r, c, 0) + img.get(r, c+1, 0)) / 3,\n      (img.get(r, c-1, 1) + img.get(r, c, 1) + img.get(r, c+1, 1)) / 3,\n      (img.get(r, c-1, 2) + img.get(r, c, 2) + img.get(r, c+1, 2)) / 3\n    ];\n    toRet[r].splice(c, 0, pixel);\n  }\n  return nj.array(toRet);\n}\n\nfunction addSeamHorizontal(img, seam) {\n  return addSeamVertical(img.transpose(1, 0), seam).transpose(1, 0);\n}\n\nexport function addSeam(img, seam, horizontal) {\n  if (horizontal) {\n    return addSeamHorizontal(img, seam);\n  }\n  return addSeamVertical(img, seam);\n}\n\nfunction addSeamToMapVertical(img, seam) {\n  for (let r = 0; r < img.shape[0]; r++) {\n    img.set(r, seam.get(r), 255);\n  }\n  return img;\n}\n\nfunction addSeamToMapHorizontal(img, seam) {\n  return addSeamToMapVertical(img.transpose(1, 0), seam).transpose(1, 0);\n}\n\nexport function addSeamToMap(img, seam, horizontal) {\n  if (horizontal) {\n    return addSeamToMapHorizontal(img, seam);\n  }\n  return addSeamToMapVertical(img, seam);\n}\n\nfunction removeSeamVertical(img, seam) {\n  const toRet = [];\n  const unrolled = img.tolist();\n\n  for (let r = 0; r < img.shape[0]; r++) {\n    toRet.push(unrolled[r]);\n    toRet[r].splice(seam.get(r), 1);\n  }\n  return nj.array(toRet);\n}\n\nfunction removeSeamHorizontal(img, seam) {\n  return removeSeamVertical(img.transpose(1, 0), seam).transpose(1, 0);\n}\n\nexport function removeSeam(img, seam, horizontal) {\n  if (horizontal) {\n    return removeSeamHorizontal(img, seam);\n  }\n  return removeSeamVertical(img, seam);\n}\n\n// sqrt(sum(xgrad .^ 2, ygrad .^ 2))\nconst doEnergyCalculation = cwise({\n  args: [\n    \"array\",\n    \"array\",\n    \"array\",\n    \"array\",\n    { offset: [0, 1], array: 1 },\n    { offset: [0, 1], array: 2 },\n    { offset: [0, 1], array: 3 },\n    { offset: [1, 0], array: 1 },\n    { offset: [1, 0], array: 2 },\n    { offset: [1, 0], array: 3 },\n  ],\n  body: function energyCalculationCwise(\n    y,\n    xR,\n    xG,\n    xB,\n    xRN,\n    xGN,\n    xBN,\n    xRE,\n    xGE,\n    xBE\n  ) {\n    y = Math.sqrt(\n      (xR - xRN) * (xR - xRN) +\n        (xR - xRE) * (xR - xRE) +\n        (xG - xGN) * (xG - xGN) +\n        (xG - xGE) * (xG - xGN) +\n        (xB - xBN) * (xB - xBN) +\n        (xB - xBE) * (xB - xBN)\n    );\n  },\n});\n\nexport function getEnergy(img, mask) {\n  var h = img.shape[0];\n  var w = img.shape[1];\n  var oShape = [h, w];\n  var out = new nj.NdArray(new Uint16Array(h * w), oShape);\n  var r = img.selection.pick(null, null, 0);\n  var g = img.selection.pick(null, null, 1);\n  var b = img.selection.pick(null, null, 2);\n  doEnergyCalculation(out.selection, r, g, b);\n\n  if (mask) {\n      out = out.add(mask);\n  }\n\n  return out;\n}\n\nfunction getMinimumSeamVertical(energy) {\n  const backtrack = nj.zeros(energy.shape);\n  const h = energy.shape[0];\n  const w = energy.shape[1];\n\n  for (let i = 1; i < h; i++) {\n    for (let j = 0; j < w; j++) {\n      let e = energy.get(i - 1, j);\n      let o = 0;\n      if (j > 0 && e > energy.get(i - 1, j - 1)) {\n        e = energy.get(i - 1, j - 1);\n        o = -1;\n      }\n      if (j < w - 1 && e > energy.get(i - 1, j + 1)) {\n        e = energy.get(i - 1, j + 1);\n        o = 1;\n      }\n      backtrack.set(i, j, j + o);\n      energy.set(i, j, energy.get(i, j) + e);\n    }\n  }\n\n  const seam = [];\n  let j = argmin(energy.slice(-1).flatten().selection);\n\n  for (let i = h - 1; i > -1; i--) {\n    seam.unshift(j);\n    j = backtrack.get(i, j);\n  }\n\n  return nj.array(seam);\n}\n\nfunction getMinimumSeamHorizontal(energy) {\n  return getMinimumSeamVertical(energy.transpose(1, 0));\n}\n\nexport function getMinimumSeam(energy, horizontal) {\n  if (horizontal) {\n    return getMinimumSeamHorizontal(energy);\n  }\n  return getMinimumSeamVertical(energy);\n}\n\n// TODO(nwestman): Implement improved seam carving https://github.com/axu2/improved-seam-carving\n\n/**\n * @param {NdArray} img - Image from which to remove seams\n * @param {number} iter - Number of pixels to remove\n * @returns Promise<NdArray[]>\n */\nexport function removeSeams(img, iter, mask = null, horizontal = false) {\n  return new Promise((resolve, reject) => {\n    const seams = [];\n    let processing = img.clone();\n    let processingMask = mask && mask.clone();\n    let timesRun = 0;\n    let interval = setInterval(function () {\n      timesRun += 1;\n      if (timesRun > iter) {\n        clearInterval(interval);\n        resolve(seams);\n        return;\n      }\n\n      const energyMap = getEnergy(processing, processingMask);\n      const seam = getMinimumSeam(energyMap.clone(), horizontal);\n      seams.unshift(seam);\n\n      const energyWithSeam = addSeamToMap(energyMap, seam, horizontal);\n      const $energy = document.getElementById(\"energy\");\n      $energy.width = energyWithSeam.shape[1];\n      $energy.height = energyWithSeam.shape[0];\n      nj.images.save(energyWithSeam, $energy);\n\n      const withoutSeam = removeSeam(processing, seam, horizontal);\n      \n      if (processingMask) {\n          processingMask = removeSeam(processingMask, seam, horizontal);\n      }\n\n      const $seam = document.getElementById(\"seam\");\n      $seam.width = withoutSeam.shape[1];\n      $seam.height = withoutSeam.shape[0];\n      nj.images.save(withoutSeam, $seam);\n\n      processing = withoutSeam;\n    }, 100);\n  });\n}\n\nexport function addSeams(img, seams, horizontal) {\n  const iter = seams.length;\n  return new Promise((resolve, reject) => {\n    let processing = img;\n    let timesRun = 0;\n    let interval = setInterval(function () {\n      timesRun += 1;\n      if (timesRun > iter) {\n        clearInterval(interval);\n        resolve();\n        return;\n      }\n\n      const seam = seams.pop();\n      const withoutSeam = addSeam(processing, seam, horizontal);\n\n      for (const remainingSeam of seams) {\n        const diff = nj.clip(remainingSeam.subtract(seam), -1, 0).add(1).multiply(2);\n        remainingSeam.add(diff, false);\n      }\n\n      const $seam = document.getElementById(\"seam\");\n      $seam.width = withoutSeam.shape[1];\n      $seam.height = withoutSeam.shape[0];\n      nj.images.save(withoutSeam, $seam);\n\n      processing = withoutSeam;\n    }, 100);\n  });\n}\n","// From https://jsfiddle.net/nicolaspanel/047gwg0q/\nimport nj from \"numjs\";\nimport { removeSeams, addSeams } from \"./seams\";\n\nexport function populateImage($image, iter, $mask) {\n  const img = nj.images.read($image).slice(null, null, [3]);\n  let mask = null;\n\n  // display images in canvas\n  const $original = document.getElementById(\"original\");\n  $original.width = img.shape[1];\n  $original.height = img.shape[0];\n  nj.images.save(img, $original);\n\n  // Should check that shapes match, eventually.\n  if ($mask) {\n    mask = nj.images.rgb2gray(nj.images.read($mask));\n\n    const $maskCanvas = document.getElementById(\"mask\");\n    $maskCanvas.width = img.shape[1];\n    $maskCanvas.height = img.shape[0];\n    nj.images.save(mask, $maskCanvas);\n  }\n\n  const horizontalCheckbox = document.querySelector(\n    \"input[type=checkbox][name=horizontal]\"\n  );\n  const horizontal = horizontalCheckbox.checked;\n\n  const addSeamsCheckbox = document.querySelector(\n    \"input[type=checkbox][name=addSeams]\"\n  );\n  const shouldAddSeams = addSeamsCheckbox.checked;\n\n  removeSeams(img, iter, mask, horizontal).then((seams) => {\n    if (shouldAddSeams) {\n      addSeams(img, seams, horizontal);\n    }\n  });\n\n  document.getElementById(\"h\").textContent = \"\" + img.shape[0];\n  document.getElementById(\"w\").textContent = \"\" + img.shape[1];\n}\n","import \"./Uploader.css\";\nimport { populateImage } from \"./loadImage\";\n\nimport React from \"react\";\n\nclass Uploader extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      image: null,\n      isButtonDisabled: true,\n      iter: 50,\n    };\n  }\n\n  loadImage(src, isMask) {\n    const $image = new Image();\n    $image.crossOrigin = \"Anonymous\";\n    $image.onload = () => {\n      if (isMask) {\n        this.setState({\n          isButtonDisabled: !this.state.image,\n          mask: $image\n        });\n        return;\n      }\n\n      this.setState({\n        isButtonDisabled: false,\n        image: $image,\n      });\n    };\n    $image.src = src;\n  }\n\n  handleFileSelect(e, isMask) {\n    const file = e.target.files[0];\n    const reader = new FileReader();\n\n    this.setState({\n      isButtonDisabled: true,\n    });\n\n    reader.onload = (e) => {\n      this.loadImage(e.target.result, isMask);\n    };\n    reader.readAsDataURL(file);\n  }\n\n  processImage(e) {\n    populateImage(this.state.image, this.state.iter, this.state.mask);\n  }\n\n  handleChange = (e) => {\n    this.setState({\n      iter: e.target.value\n    })\n  }\n\n  render() {\n    return (\n      <>\n        <div className=\"Uploader\">\n        <div className=\"option\">\n            <input type=\"number\" id=\"iter\" name=\"iter\" value={this.state.num} onChange={(e) => this.handleChange(e)}></input>\n            <label htmlFor=\"horizontal\">Number of iterations</label>\n          </div>\n          <div className=\"option\">\n            <input type=\"checkbox\" id=\"horizontal\" name=\"horizontal\"></input>\n            <label htmlFor=\"horizontal\">Horizontal?</label>\n          </div>\n          <div className=\"option\">\n            <input type=\"checkbox\" id=\"addSeams\" name=\"addSeams\"></input>\n            <label htmlFor=\"addSeams\">Add Seams?</label>\n          </div>\n          <div className=\"option\">\n            <label htmlFor=\"file\">Image</label>\n            <input\n              onChange={(e) => this.handleFileSelect(e)}\n              type=\"file\"\n              id=\"file\"\n              name=\"file\"\n            ></input>\n          </div>\n          <div className=\"option\">\n            <label htmlFor=\"file\">Image Mask (Optional)</label>\n            <input\n              onChange={(e) => this.handleFileSelect(e, true)}\n              type=\"file\"\n              id=\"maskFile\"\n              name=\"maskFile\"\n            ></input>\n          </div>\n          <button\n            onClick={(e) => this.processImage()}\n            type=\"button\"\n            disabled={this.state.isButtonDisabled}\n          >\n            Start\n          </button>\n        </div>\n\n        <div>\n          <h3>\n            Original image (h<span id=\"h\"></span>, w<span id=\"w\"></span>)\n          </h3>\n          <canvas id=\"original\"></canvas>\n        </div>\n        <div>\n          <h3>\n            Mask\n          </h3>\n          <canvas id=\"mask\"></canvas>\n        </div>\n        <div>\n          <div className=\"il\">\n            <h4>Energy</h4>\n            <canvas id=\"energy\"></canvas>\n          </div>\n          <div className=\"il\">\n            <h4>Seam</h4>\n            <canvas id=\"seam\"></canvas>\n          </div>\n        </div>\n        <p>\n          Processing took <span id=\"duration\"></span>ms\n        </p>\n      </>\n    );\n  }\n}\n\nexport default Uploader;\n","import \"./App.css\";\nimport Uploader from \"./upload/Uploader.js\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <p>Seam Carving</p>\n      </header>\n      <Uploader />\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}